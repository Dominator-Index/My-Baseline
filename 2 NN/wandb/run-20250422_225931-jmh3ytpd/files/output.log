
===> Starting training with SGD...
Total parameters: 832
SGD training:   6%|████████▍                                                                                                                               | 31/500 [01:09<12:25,  1.59s/it, loss=5.8072]
SGD step 0: 84.6749
SGD step 1: 69.5072
SGD step 2: 58.3134
SGD step 3: 49.7692
SGD step 4: 43.0716
SGD step 5: 37.7072
SGD step 6: 33.3331
SGD step 7: 29.7123
SGD step 8: 26.6763
SGD step 9: 24.1020
SGD step 10: 21.8978
SGD step 11: 19.9941
SGD step 12: 18.3372
SGD step 13: 16.8853
SGD step 14: 15.6050
SGD step 15: 14.4697
SGD step 16: 13.4579
SGD step 17: 12.5517
SGD step 18: 11.7368
SGD step 19: 11.0010
SGD step 20: 10.3341
SGD step 21: 9.7278
SGD step 22: 9.1746
SGD step 23: 8.6685
SGD step 24: 8.2042
SGD step 25: 7.7771
SGD step 26: 7.3832
SGD step 27: 7.0192
SGD step 28: 6.6821
SGD step 29: 6.3692
SGD step 30: 6.0783
SGD step 31: 5.8072
SGD step 32: 5.5542
SGD step 33: 5.3178
SGD step 34: 5.0964
SGD step 35: 4.8888
SGD step 36: 4.6938
SGD step 37: 4.5106
SGD step 38: 4.3380
SGD step 39: 4.1753
SGD step 40: 4.0218
SGD step 41: 3.8767
SGD step 42: 3.7394
SGD step 43: 3.6095
SGD step 44: 3.4863
SGD step 45: 3.3693
SGD step 46: 3.2583
SGD step 47: 3.1528
SGD step 48: 3.0523
SGD step 49: 2.9567
SGD step 50: 2.8656
SGD step 51: 2.7786
SGD step 52: 2.6957
SGD step 53: 2.6164
SGD step 54: 2.5406
SGD step 55: 2.4681
SGD step 56: 2.3988
SGD step 57: 2.3323
SGD step 58: 2.2686
SGD step 59: 2.2075
SGD step 60: 2.1489
SGD step 61: 2.0926
SGD step 62: 2.0385
SGD step 63: 1.9865
SGD step 64: 1.9365
SGD step 65: 1.8884
SGD step 66: 1.8421
SGD step 67: 1.7975
SGD step 68: 1.7545
SGD step 69: 1.7130
SGD step 70: 1.6731
SGD step 71: 1.6345
SGD step 72: 1.5972
SGD step 73: 1.5613
SGD step 74: 1.5265
SGD step 75: 1.4929
SGD step 76: 1.4604
SGD step 77: 1.4290
SGD step 78: 1.3986
SGD step 79: 1.3692
SGD step 80: 1.3407
SGD step 81: 1.3130
SGD step 82: 1.2863
SGD step 83: 1.2603
SGD step 84: 1.2352
SGD step 85: 1.2108
SGD step 86: 1.1871
SGD step 87: 1.1641
SGD step 88: 1.1418
SGD step 89: 1.1201
SGD step 90: 1.0991
SGD step 91: 1.0786
SGD step 92: 1.0587
SGD step 93: 1.0394
SGD step 94: 1.0206
SGD step 95: 1.0023
SGD step 96: 0.9845
SGD step 97: 0.9672
SGD step 98: 0.9503
SGD step 99: 0.9339
SGD step 100: 0.9179
SGD step 101: 0.9023
SGD step 102: 0.8871
SGD step 103: 0.8723
SGD step 104: 0.8579
SGD step 105: 0.8438
SGD step 106: 0.8301
SGD step 107: 0.8167
SGD step 108: 0.8036
SGD step 109: 0.7909
SGD step 110: 0.7784
SGD step 111: 0.7663
SGD step 112: 0.7544
SGD step 113: 0.7428
SGD step 114: 0.7315
SGD step 115: 0.7204
SGD step 116: 0.7096
SGD step 117: 0.6990
SGD step 118: 0.6887
SGD step 119: 0.6786
SGD step 120: 0.6687
SGD step 121: 0.6591
SGD step 122: 0.6496
SGD step 123: 0.6404
SGD step 124: 0.6314
SGD step 125: 0.6225
SGD step 126: 0.6138
SGD step 127: 0.6053
SGD step 128: 0.5970
SGD step 129: 0.5889
SGD step 130: 0.5809
SGD step 131: 0.5731
SGD step 132: 0.5655
SGD step 133: 0.5580
SGD step 134: 0.5507
SGD step 135: 0.5435
SGD step 136: 0.5364
SGD step 137: 0.5295
SGD step 138: 0.5227
SGD step 139: 0.5160
SGD step 140: 0.5095
SGD step 141: 0.5031
SGD step 142: 0.4968
SGD step 143: 0.4907
SGD step 144: 0.4846
SGD step 145: 0.4787
SGD step 146: 0.4729
SGD step 147: 0.4672
SGD step 148: 0.4616
SGD step 149: 0.4561
SGD step 150: 0.4506
SGD step 151: 0.4453
SGD step 152: 0.4401
SGD step 153: 0.4350
SGD step 154: 0.4300
SGD step 155: 0.4250
SGD step 156: 0.4201
SGD step 157: 0.4154
SGD step 158: 0.4107
SGD step 159: 0.4061
SGD step 160: 0.4015
SGD step 161: 0.3971
SGD step 162: 0.3927
SGD step 163: 0.3884
SGD step 164: 0.3841
SGD step 165: 0.3800
SGD step 166: 0.3759
SGD step 167: 0.3718
SGD step 168: 0.3679
SGD step 169: 0.3640
SGD step 170: 0.3601
SGD step 171: 0.3563
SGD step 172: 0.3526
SGD step 173: 0.3490
SGD step 174: 0.3454
SGD step 175: 0.3418
SGD step 176: 0.3383
SGD step 177: 0.3349
SGD step 178: 0.3315
SGD step 179: 0.3282
SGD step 180: 0.3249
SGD step 181: 0.3217
SGD step 182: 0.3185
SGD step 183: 0.3153
SGD step 184: 0.3123
SGD step 185: 0.3092
SGD step 186: 0.3062
SGD step 187: 0.3033
SGD step 188: 0.3004
SGD step 189: 0.2975
SGD step 190: 0.2947
SGD step 191: 0.2919
SGD step 192: 0.2891
SGD step 193: 0.2864
SGD step 194: 0.2838
SGD step 195: 0.2811
SGD step 196: 0.2785
SGD step 197: 0.2760
SGD step 198: 0.2735
SGD step 199: 0.2710
SGD step 200: 0.2685
SGD step 201: 0.2661
SGD step 202: 0.2637
SGD step 203: 0.2614
SGD step 204: 0.2591
SGD step 205: 0.2568
SGD step 206: 0.2545
SGD step 207: 0.2523
SGD step 208: 0.2501
SGD step 209: 0.2479
SGD step 210: 0.2458
SGD step 211: 0.2437
SGD step 212: 0.2416
SGD step 213: 0.2395
SGD step 214: 0.2375
SGD step 215: 0.2355
SGD step 216: 0.2335
SGD step 217: 0.2316
SGD step 218: 0.2296
SGD step 219: 0.2277
SGD step 220: 0.2258
SGD step 221: 0.2240
SGD step 222: 0.2222
SGD step 223: 0.2204
SGD step 224: 0.2186
SGD step 225: 0.2168
SGD step 226: 0.2151
SGD step 227: 0.2133
SGD step 228: 0.2116
SGD step 229: 0.2100
SGD step 230: 0.2083
SGD step 231: 0.2067
SGD step 232: 0.2050
SGD step 233: 0.2034
SGD step 234: 0.2019
SGD step 235: 0.2003
SGD step 236: 0.1988
SGD step 237: 0.1972
SGD step 238: 0.1957
SGD step 239: 0.1942
SGD step 240: 0.1928
SGD step 241: 0.1913
SGD step 242: 0.1899
SGD step 243: 0.1884
SGD step 244: 0.1870
SGD step 245: 0.1856
SGD step 246: 0.1843
SGD step 247: 0.1829
SGD step 248: 0.1816
SGD step 249: 0.1802
SGD step 250: 0.1789
SGD step 251: 0.1776
SGD step 252: 0.1764
SGD step 253: 0.1751
SGD step 254: 0.1738
SGD step 255: 0.1726
SGD step 256: 0.1714
SGD step 257: 0.1701
SGD step 258: 0.1689
SGD step 259: 0.1678
SGD step 260: 0.1666
SGD step 261: 0.1654
SGD step 262: 0.1643
SGD step 263: 0.1631
SGD step 264: 0.1620
SGD step 265: 0.1609
SGD step 266: 0.1598
SGD step 267: 0.1587
SGD step 268: 0.1576
SGD step 269: 0.1566
SGD step 270: 0.1555
SGD step 271: 0.1545
SGD step 272: 0.1534
SGD step 273: 0.1524
SGD step 274: 0.1514
SGD step 275: 0.1504
SGD step 276: 0.1494
SGD step 277: 0.1484
SGD step 278: 0.1474
SGD step 279: 0.1465
SGD step 280: 0.1455
SGD step 281: 0.1446
SGD step 282: 0.1436
SGD step 283: 0.1427
SGD step 284: 0.1418
SGD step 285: 0.1409
SGD step 286: 0.1400
SGD step 287: 0.1391
SGD step 288: 0.1382
SGD step 289: 0.1374
SGD step 290: 0.1365
SGD step 291: 0.1356
SGD step 292: 0.1348
SGD step 293: 0.1339
SGD step 294: 0.1331
SGD step 295: 0.1323
SGD step 296: 0.1315
SGD step 297: 0.1307
SGD step 298: 0.1299
SGD step 299: 0.1291
SGD step 300: 0.1283
SGD step 301: 0.1275
SGD step 302: 0.1268
SGD step 303: 0.1260
SGD step 304: 0.1252
SGD step 305: 0.1245
SGD step 306: 0.1238
SGD step 307: 0.1230
SGD step 308: 0.1223
SGD step 309: 0.1216
SGD step 310: 0.1209
SGD step 311: 0.1201
SGD step 312: 0.1194
SGD step 313: 0.1188
SGD step 314: 0.1181
SGD step 315: 0.1174
SGD step 316: 0.1167
SGD step 317: 0.1160
SGD step 318: 0.1154
SGD step 319: 0.1147
SGD step 320: 0.1141
SGD step 321: 0.1134
SGD step 322: 0.1128
SGD step 323: 0.1121
SGD step 324: 0.1115
SGD step 325: 0.1109
SGD step 326: 0.1103
SGD step 327: 0.1097
SGD step 328: 0.1090
SGD step 329: 0.1084
SGD step 330: 0.1078
SGD step 331: 0.1073
SGD step 332: 0.1067
SGD step 333: 0.1061
SGD step 334: 0.1055
SGD step 335: 0.1049
SGD step 336: 0.1044
SGD step 337: 0.1038
SGD step 338: 0.1032
SGD step 339: 0.1027
SGD step 340: 0.1021
SGD step 341: 0.1016
SGD step 342: 0.1011
SGD step 343: 0.1005
SGD step 344: 0.1000
SGD step 345: 0.0995
SGD step 346: 0.0989
SGD step 347: 0.0984
SGD step 348: 0.0979
SGD step 349: 0.0974
SGD step 350: 0.0969
SGD step 351: 0.0964
SGD step 352: 0.0959
SGD step 353: 0.0954
SGD step 354: 0.0949
SGD step 355: 0.0944
SGD step 356: 0.0940
SGD step 357: 0.0935
SGD step 358: 0.0930
SGD step 359: 0.0925
SGD step 360: 0.0921
SGD step 361: 0.0916
SGD step 362: 0.0911
SGD step 363: 0.0907
SGD step 364: 0.0902
SGD step 365: 0.0898
SGD step 366: 0.0893
SGD step 367: 0.0889
SGD step 368: 0.0885
SGD step 369: 0.0880
SGD step 370: 0.0876
SGD step 371: 0.0872
SGD step 372: 0.0868
SGD step 373: 0.0863
SGD step 374: 0.0859
SGD step 375: 0.0855
SGD step 376: 0.0851
SGD step 377: 0.0847
SGD step 378: 0.0843
SGD step 379: 0.0839
SGD step 380: 0.0835
SGD step 381: 0.0831
SGD step 382: 0.0827
SGD step 383: 0.0823
SGD step 384: 0.0819
SGD step 385: 0.0815
SGD step 386: 0.0811
SGD step 387: 0.0808
SGD step 388: 0.0804
SGD step 389: 0.0800
SGD step 390: 0.0796
SGD step 391: 0.0793
SGD step 392: 0.0789
SGD step 393: 0.0785
SGD step 394: 0.0782
SGD step 395: 0.0778
SGD step 396: 0.0775
SGD step 397: 0.0771
SGD step 398: 0.0768
SGD step 399: 0.0764
SGD step 400: 0.0761
SGD step 401: 0.0757
SGD step 402: 0.0754
SGD step 403: 0.0751
SGD step 404: 0.0747
SGD step 405: 0.0744
SGD step 406: 0.0741
SGD step 407: 0.0737
SGD step 408: 0.0734
SGD step 409: 0.0731
SGD step 410: 0.0728
SGD step 411: 0.0724
SGD step 412: 0.0721
SGD step 413: 0.0718
SGD step 414: 0.0715
SGD step 415: 0.0712
SGD step 416: 0.0709
SGD step 417: 0.0706
SGD step 418: 0.0703
SGD step 419: 0.0700
SGD step 420: 0.0697
SGD step 421: 0.0694
SGD step 422: 0.0691
SGD step 423: 0.0688
SGD step 424: 0.0685
SGD step 425: 0.0682
SGD step 426: 0.0679
SGD step 427: 0.0676
SGD step 428: 0.0674
SGD step 429: 0.0671
SGD step 430: 0.0668
SGD step 431: 0.0665
SGD step 432: 0.0662
SGD step 433: 0.0660
SGD step 434: 0.0657
SGD step 435: 0.0654
SGD step 436: 0.0652
SGD step 437: 0.0649
SGD step 438: 0.0646
SGD step 439: 0.0644
SGD step 440: 0.0641
SGD step 441: 0.0638
SGD step 442: 0.0636
SGD step 443: 0.0633
SGD step 444: 0.0631
SGD step 445: 0.0628
SGD step 446: 0.0626
SGD step 447: 0.0623
SGD step 448: 0.0621
SGD step 449: 0.0618
SGD step 450: 0.0616
SGD step 451: 0.0613
SGD step 452: 0.0611
SGD step 453: 0.0608
SGD step 454: 0.0606
SGD step 455: 0.0604
SGD step 456: 0.0601
SGD step 457: 0.0599
SGD step 458: 0.0597
SGD step 459: 0.0594
SGD step 460: 0.0592
SGD step 461: 0.0590
SGD step 462: 0.0587
SGD step 463: 0.0585
SGD step 464: 0.0583
SGD step 465: 0.0581
SGD step 466: 0.0578
SGD step 467: 0.0576
SGD step 468: 0.0574
SGD step 469: 0.0572
SGD step 470: 0.0570
SGD step 471: 0.0568
SGD step 472: 0.0565
SGD step 473: 0.0563
SGD step 474: 0.0561
SGD step 475: 0.0559
SGD step 476: 0.0557
SGD step 477: 0.0555
SGD step 478: 0.0553
SGD step 479: 0.0551
SGD step 480: 0.0549
SGD step 481: 0.0547
SGD step 482: 0.0545
SGD step 483: 0.0543
SGD step 484: 0.0541
SGD step 485: 0.0539
SGD step 486: 0.0537
SGD step 487: 0.0535
SGD step 488: 0.0533
SGD step 489: 0.0531
SGD step 490: 0.0529
SGD step 491: 0.0527
SGD step 492: 0.0525
SGD step 493: 0.0523
SGD step 494: 0.0521
SGD step 495: 0.0520
SGD step 496: 0.0518
SGD step 497: 0.0516
SGD step 498: 0.0514
SGD step 499: 0.0512
✅ Finished training with SGD in 266.03 seconds.
Traceback (most recent call last):
  File "/home/ouyangzl/BaseLine/2 NN/test-plot-curvature-1.py", line 141, in <module>
    all_curvatures[optim_name] = curvature_projection_trajectory(
                                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ouyangzl/BaseLine/2 NN/Curvature_update.py", line 107, in curvature_projection_trajectory
    proj = curvature_dominant_projection(lambs, eigvecs, v_prev, top_k)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/ouyangzl/BaseLine/2 NN/Curvature_update.py", line 85, in curvature_dominant_projection
    Pk = U_k @ (Lambda_k @ U_k.T)             # shape (p, p)
                ~~~~~~~~~^~~~~~~
ValueError: matmul: Input operand 1 has a mismatch in its core dimension 0, with gufunc signature (n?,k),(k,m?)->(n?,m?) (size 5 is different from 10)
