test_model.py is used to test if model (artitruary layers) is equivalent to 3 NN model if num_layer is 3.
Test Result:
ğŸš€ å¼€å§‹æ¨¡å‹éªŒè¯
ğŸ–¥ï¸ è®¾å¤‡: cuda

ğŸ§ª æµ‹è¯•3NNæ¨¡å‹åˆ›å»º:
   æ¨¡å‹è®¾å¤‡: cpu
   W1å½¢çŠ¶: torch.Size([32, 16])
   W2å½¢çŠ¶: torch.Size([32, 32])
   W3å½¢çŠ¶: torch.Size([10, 32])

ğŸ§ª æµ‹è¯•Experiment_10æ¨¡å‹åˆ›å»º:
   æ¨¡å‹è®¾å¤‡: cuda:0
   å±‚æ•°: 3
   Layer0å½¢çŠ¶: torch.Size([32, 16])
   Layer1å½¢çŠ¶: torch.Size([32, 32])
   Layer2å½¢çŠ¶: torch.Size([10, 32])

==================================================
ğŸ–¥ï¸ ä½¿ç”¨è®¾å¤‡: cuda
ğŸ—ï¸ åˆ›å»º3NNæ¨¡å‹...
ğŸ—ï¸ åˆ›å»ºExperiment_10æ¨¡å‹...
ğŸ” Model3NNè®¾å¤‡: cuda:0
ğŸ” ModelExp10è®¾å¤‡: cuda:0
ğŸ” Identityè®¾å¤‡: cuda:0
âš¡ è®¡ç®—3NNè¾“å‡º...
3NNè¾“å‡ºå½¢çŠ¶: torch.Size([10, 16]), è®¾å¤‡: cuda:0
âš¡ è®¡ç®—Experiment_10è¾“å‡º...
Exp10è¾“å‡ºå½¢çŠ¶: torch.Size([1, 10, 16]), è®¾å¤‡: cuda:0
ğŸ” è¾“å‡ºå·®å¼‚: 0.0
ğŸ” éªŒè¯æƒé‡ä¹˜ç§¯...
ğŸ” æƒé‡ä¹˜ç§¯å·®å¼‚: 0.0
âœ… æ¨¡å‹ç­‰ä»· (é˜ˆå€¼1e-5): True

ğŸ“Š è¯¦ç»†åˆ†æ:
   è¾“å‡ºå·®å¼‚: 0.00e+00
   æƒé‡å·®å¼‚: 0.00e+00
   æ˜¯å¦ç­‰ä»·: True

They are equal.

test_learning.py is used to test if the two model are equivalent when they are trained using SGD optimizer.
ğŸš€ å¼€å§‹SGDè®­ç»ƒç­‰ä»·æ€§æµ‹è¯•
ğŸ–¥ï¸ ä½¿ç”¨è®¾å¤‡: cuda
ğŸ“Š è®­ç»ƒæ•°æ®:
   è¾“å…¥å½¢çŠ¶: torch.Size([1, 16, 16])
   ç›®æ ‡å½¢çŠ¶: torch.Size([1, 10, 16])
   ç›®æ ‡rank: 3

ğŸ—ï¸ åˆ›å»ºå¹¶è®­ç»ƒ3NNæ¨¡å‹...
ğŸš€ å¼€å§‹è®­ç»ƒ3NNæ¨¡å‹...
   Step   0: Loss = 0.018633
   Step  10: Loss = 0.018622
   Step  20: Loss = 0.018611
   Step  30: Loss = 0.018599
   Step  40: Loss = 0.018588
   Step  50: Loss = 0.018576
   Step  60: Loss = 0.018565
   Step  70: Loss = 0.018553
   Step  80: Loss = 0.018541
   Step  90: Loss = 0.018530

ğŸ—ï¸ åˆ›å»ºå¹¶è®­ç»ƒExperiment_10æ¨¡å‹...
ğŸš€ å¼€å§‹è®­ç»ƒExperiment_10æ¨¡å‹...
   Step   0: Loss = 0.018633
   Step  10: Loss = 0.018622
   Step  20: Loss = 0.018611
   Step  30: Loss = 0.018599
   Step  40: Loss = 0.018588
   Step  50: Loss = 0.018576
   Step  60: Loss = 0.018565
   Step  70: Loss = 0.018553
   Step  80: Loss = 0.018541
   Step  90: Loss = 0.018530

ğŸ“Š è®­ç»ƒç»“æœæ¯”è¾ƒ:
   æœ€ç»ˆæŸå¤±å·®å¼‚: 0.00e+00
   æœ€ç»ˆè¾“å‡ºå·®å¼‚: 0.00e+00
   æƒé‡ä¹˜ç§¯å·®å¼‚: 0.00e+00

âœ… è®­ç»ƒç­‰ä»·æ€§: True
/home/ouyangzl/BaseLine/Test model/test_learning.py:146: UserWarning: Data has no positive values, and therefore cannot be log-scaled.
  plt.yscale('log')
/home/ouyangzl/BaseLine/Test model/test_learning.py:161: UserWarning: Data has no positive values, and therefore cannot be log-scaled.
  plt.yscale('log')

ğŸ“ˆ å›¾è¡¨å·²ä¿å­˜ä¸º 'training_comparison.png'

============================================================

ğŸ§ª æµ‹è¯•ä¸åŒè¾“å…¥ç±»å‹:

ğŸ“‹ æµ‹è¯•è¾“å…¥ç±»å‹: identity
   è¾“å‡ºå·®å¼‚: 0.00e+00
   é¢„æœŸç›¸ç­‰: True
   å®é™…ç›¸ç­‰: True

ğŸ“‹ æµ‹è¯•è¾“å…¥ç±»å‹: random
   è¾“å‡ºå·®å¼‚: 1.26e-01
   é¢„æœŸç›¸ç­‰: False
   å®é™…ç›¸ç­‰: False

ğŸ“‹ æµ‹è¯•è¾“å…¥ç±»å‹: ones
   è¾“å‡ºå·®å¼‚: 6.52e-02
   é¢„æœŸç›¸ç­‰: False
   å®é™…ç›¸ç­‰: False

ğŸ“‹ æµ‹è¯•è¾“å…¥ç±»å‹: scaled_identity
   è¾“å‡ºå·®å¼‚: 2.62e-02
   é¢„æœŸç›¸ç­‰: False
   å®é™…ç›¸ç­‰: False

============================================================
ğŸ¯ æµ‹è¯•æ€»ç»“:
   SGDè®­ç»ƒç­‰ä»·æ€§: True
   æœ€ç»ˆè¾“å‡ºå·®å¼‚: 0.00e+00
   æœ€ç»ˆæƒé‡å·®å¼‚: 0.00e+00
   æœ€ç»ˆæŸå¤±å·®å¼‚: 0.00e+00
âœ… ä¸¤ä¸ªæ¨¡å‹åœ¨SGDè®­ç»ƒä¸‹å®Œå…¨ç­‰ä»·ï¼
